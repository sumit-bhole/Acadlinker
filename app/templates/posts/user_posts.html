{% extends 'base.html' %}

{% block content %}
<style>
    .post-card {
        transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        border: none;
        border-radius: 0.75rem;
    }

    .post-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }

    .post-actions a {
        color: #6c757d;
        transition: color 0.2s;
        text-decoration: none;
    }

    .post-actions a:hover {
        color: #0d6efd;
    }
</style>

<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="mb-0">My Posts</h2>
                <a href="{{ url_for('posts.create_post') }}" class="btn btn-dark">
                    <i class="fas fa-plus me-2"></i>Create New Post
                </a>
            </div>

            {% for post in posts %}
            <div class="card shadow-sm mb-4 post-card">
                <div class="card-body p-4">
                    <div class="d-flex justify-content-between align-items-start">
                        <h4 class="card-title mb-1">{{ post.title }}</h4>
                        <div class="post-actions d-flex gap-3">
                            <a href="#" title="Edit Post"><i class="fas fa-edit"></i></a>
                            <a href="#" title="Delete Post"
                                onclick="return confirm('Are you sure you want to delete this post?');"><i
                                    class="fas fa-trash-alt"></i></a>
                        </div>
                    </div>
                    <small class="text-muted d-block mb-3">Posted on {{ post.timestamp.strftime('%B %d, %Y') }}</small>

                    <p class="card-text">{{ post.description }}</p>

                    {% if post.file_name %}
                    {% set ext = post.file_name.split('.')[-1]|lower %}
                    <div class="mt-3">
                        {% if ext in ['jpg', 'jpeg', 'png', 'gif'] %}
                        <a href="{{ url_for('static', filename='uploads/' + post.file_name) }}" target="_blank">
                            <img src="{{ url_for('static', filename='uploads/' + post.file_name) }}" alt="Post Image"
                                class="img-fluid rounded border w-100" style="max-height: 400px;">
                        </a>
                        {% else %}
                        <a href="{{ url_for('static', filename='uploads/' + post.file_name) }}" target="_blank"
                            class="btn btn-outline-secondary btn-sm">
                            <i class="fas fa-paperclip me-2"></i> Download File ({{ ext }})
                        </a>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
            </div>
            {% else %}
            <div class="card shadow-sm">
                <div class="card-body text-center text-muted p-5">
                    <i class="fas fa-file-alt fa-3x mb-3"></i>
                    <h5 class="card-title">You Haven't Posted Anything Yet</h5>
                    <p>Click the button above to create your first post!</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}